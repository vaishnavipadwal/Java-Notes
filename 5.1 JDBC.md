# **JDBC (Java Database Connectivity)**

JDBC (Java Database Connectivity) is an API (Application Programming Interface) in Java that allows Java applications to interact with databases. It enables Java programs to execute SQL queries, update database records, and retrieve data from a database.

JDBC provides a standard set of interfaces and classes to connect to various databases like MySQL, Oracle, SQL Server, etc.

---

## Key Concepts of JDBC:

1. **JDBC Drivers:**  
   JDBC uses drivers to connect to different types of databases. There are four types of JDBC drivers:
   - **Type 1**: JDBC-ODBC Bridge driver (deprecated).
   - **Type 2**: Native-API driver.
   - **Type 3**: Network Protocol driver.
   - **Type 4**: Thin driver (most commonly used).

2. **JDBC API Components:**
   - **Connection:** Represents a connection to the database.
   - **Statement:** Used to send SQL queries to the database.
   - **PreparedStatement:** A special version of `Statement` that allows for precompiled SQL queries with parameters.
   - **ResultSet:** Holds the data returned by a SELECT query.
   - **SQLException:** Handles SQL-related errors.

3. **Steps to Use JDBC:**
   - **Step 1:** Load the JDBC driver.
   - **Step 2:** Establish a connection to the database.
   - **Step 3:** Create a statement or prepared statement.
   - **Step 4:** Execute the query.
   - **Step 5:** Process the result (if it's a SELECT query).
   - **Step 6:** Close the connection.

---

## Example JDBC Program:

#### 1. **Database Setup:**
   First, create a simple `users` table in MySQL:
   
```sql
CREATE DATABASE testdb;

USE testdb;

CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50),
    email VARCHAR(50)
);

INSERT INTO users (name, email) VALUES ('John Doe', 'john@example.com');
INSERT INTO users (name, email) VALUES ('Jane Smith', 'jane@example.com');
```

---

#### 2. **JDBC Program (Java):**
This program connects to the database and fetches the records from the `users` table.

```java
import java.sql.*;

public class JdbcExample {
    public static void main(String[] args) {
        // Step 1: Import JDBC packages
        try {
            // Step 2: Load and register the JDBC driver (MySQL in this case)
            Class.forName("com.mysql.cj.jdbc.Driver");

            // Step 3: Establish the connection to the database
            Connection con = DriverManager.getConnection(
                "jdbc:mysql://localhost:3306/testdb", "root", "password");

            // Step 4: Create a Statement object
            Statement stmt = con.createStatement();

            // Step 5: Execute a SELECT query
            ResultSet rs = stmt.executeQuery("SELECT * FROM users");

            // Step 6: Process the result set
            while (rs.next()) {
                int id = rs.getInt("id");
                String name = rs.getString("name");
                String email = rs.getString("email");

                // Display the results
                System.out.println("ID: " + id + ", Name: " + name + ", Email: " + email);
            }

            // Close the connection
            con.close();

        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
        }
    }
}
```

---

### Explanation of the Program:

1. **Class.forName("com.mysql.cj.jdbc.Driver");**
   - Loads the MySQL JDBC driver, allowing the Java program to communicate with the MySQL database.

2. **DriverManager.getConnection(...);**
   - Establishes a connection to the MySQL database using the provided URL (`jdbc:mysql://localhost:3306/testdb`), username (`root`), and password (`password`).

3. **Statement stmt = con.createStatement();**
   - Creates a `Statement` object that will be used to execute SQL queries.

4. **stmt.executeQuery("SELECT * FROM users");**
   - Executes the SQL query to select all records from the `users` table and returns the result as a `ResultSet`.

5. **ResultSet rs = stmt.executeQuery(...);**
   - The `ResultSet` holds the data returned by the query. We loop through each row and retrieve the `id`, `name`, and `email` columns.

6. **con.close();**
   - Closes the database connection after the query execution.

---

### Common JDBC Operations:

1. **Insert Data:**
```java
PreparedStatement pstmt = con.prepareStatement("INSERT INTO users (name, email) VALUES (?, ?)");
pstmt.setString(1, "Alice");
pstmt.setString(2, "alice@example.com");
int rows = pstmt.executeUpdate();  // Executes INSERT query
System.out.println(rows + " row(s) inserted.");
```

2. **Update Data:**
```java
PreparedStatement pstmt = con.prepareStatement("UPDATE users SET email = ? WHERE name = ?");
pstmt.setString(1, "newemail@example.com");
pstmt.setString(2, "John Doe");
int rows = pstmt.executeUpdate();  // Executes UPDATE query
System.out.println(rows + " row(s) updated.");
```

3. **Delete Data:**
```java
PreparedStatement pstmt = con.prepareStatement("DELETE FROM users WHERE name = ?");
pstmt.setString(1, "Jane Smith");
int rows = pstmt.executeUpdate();  // Executes DELETE query
System.out.println(rows + " row(s) deleted.");
```

---

### Important Topics in JDBC:

1. **JDBC Drivers:**
   - JDBC drivers are required to establish a connection with the database. Each database (MySQL, Oracle, PostgreSQL) requires a specific driver.

2. **Connection Interface:**
   - Represents a connection to the database and is used to create statements, prepare queries, and manage transactions.

3. **Statement Interface:**
   - Used to execute SQL queries. There are three types of statements:
     - **Statement:** For basic SQL queries.
     - **PreparedStatement:** For precompiled SQL queries with parameters.
     - **CallableStatement:** For calling stored procedures.

4. **ResultSet Interface:**
   - Stores the results of a query and allows access to the retrieved data.

5. **Transaction Management:**
   - JDBC supports **manual transaction management**, which means you can control when a transaction starts, commits, or rolls back using:
     - `con.setAutoCommit(false);` to disable auto-commit.
     - `con.commit();` to commit the transaction.
     - `con.rollback();` to roll back the transaction.

---

### Error Handling in JDBC:

- **SQLException** is used to handle errors that occur during database operations.
- Always use **try-catch blocks** to handle exceptions in JDBC, and ensure that the connection is closed to prevent resource leaks.

```java
try {
    // JDBC operations
} catch (SQLException e) {
    System.out.println("SQL Error: " + e.getMessage());
} finally {
    try {
        if (con != null) con.close();  // Ensure connection is closed
    } catch (SQLException e) {
        e.printStackTrace();
    }
}
```

---

